
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>9. Simple models &#8212; Mathematics for Natural Sciences B</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="10. Chemical concentrations" href="../case-studies/chemicals.html" />
    <link rel="prev" title="8. Infinite powers" href="../second/powers.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics for Natural Sciences B</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DATA TRENDS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../first/numbers.html">
   1. Representing numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/plotstuff.html">
   2. Graphing data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/exponentials.html">
   3. Exponential trends
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/curvefit.html">
   4. Fitting curves
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  INFINITESIMALS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../second/pfrac.html">
   5. Rational functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../second/limits.html">
   6. Know your limits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../second/changes.html">
   7. Rates of change
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../second/powers.html">
   8. Infinite powers
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DYNAMIC MODELS
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   9. Simple models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CASE STUDIES
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../case-studies/chemicals.html">
   10. Chemical concentrations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../case-studies/freshwater.html">
   11. Freshwater sustainability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../case-studies/coronavirus.html">
   12. Viral trends
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../case-studies/faustmann.html">
   13. Forestry management
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ASSIGNMENTS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/homework.html">
   Maths coursework 1 [20%]
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fthird/first_order.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/third/first_order.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exponential-model">
   9.1. Exponential model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numeric-solution">
   9.2. Numeric solution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     9.2.1. Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#offset-model">
   9.3. Offset model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#restricted-growth-models">
   9.4. Restricted growth models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#to-be-continued">
     9.4.1. To be continued…
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Simple models</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exponential-model">
   9.1. Exponential model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numeric-solution">
   9.2. Numeric solution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     9.2.1. Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#offset-model">
   9.3. Offset model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#restricted-growth-models">
   9.4. Restricted growth models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#to-be-continued">
     9.4.1. To be continued…
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="simple-models">
<h1><span class="section-number">9. </span>Simple models<a class="headerlink" href="#simple-models" title="Permalink to this heading">#</a></h1>
<p>We will begin to explore some differential equations, their meaning, and their solutions.</p>
<div class="exercise admonition" id="third/first_order-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 9.1 </span></p>
<section id="exercise-content">
<p>Water flows out of a bucket at a constant rate of 0.1L/sec. Write down an equation for the amount of water <span class="math notranslate nohighlight">\(V\)</span> left in the bucket at time <span class="math notranslate nohighlight">\(t\)</span>. Is it realistic?</p>
</section>
</div>
<div class="toggle docutils container">
<p>Let <span class="math notranslate nohighlight">\(V(t)\)</span> be the amount of water (in litres) left in the bucket at time <span class="math notranslate nohighlight">\(t\)</span> (in seconds). According to the given information,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{\mathrm{d}V}{\mathrm{d}t}=-0.1 \quad \Rightarrow V(t)=V_0 - 0.1t
\end{equation*}\]</div>
<p>It works until the bucket is empty!</p>
<p>However, the rate of outflow may depend on water level in the bucket (e.g. due to pressure)</p>
</div>
<hr class="docutils" />
<div class="exercise admonition" id="third/first_order-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 9.2 </span></p>
<section id="exercise-content">
<p>Newton’s second law says that Force=mass <span class="math notranslate nohighlight">\(\times\)</span> acceleration.</p>
<p>Can you write this down as a problem involving velocity <span class="math notranslate nohighlight">\(v\)</span>?</p>
</section>
</div>
<div class="toggle docutils container">
<p>We use the fact that acceleration is the rate of change of velocity to write result in mathematical form as:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
F=m\frac{\mathrm{d}v}{\mathrm{d}t}
\end{equation*}\]</div>
<p>We may also write the equation in terms of the displacement, using the fact that the velocity is the rate of change of displacement:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
F= m \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\mathrm{d}x}{\mathrm{d}t}\right)=m\frac{\mathrm{d}^2 x}{\mathrm{d}t^2}
\end{equation*}\]</div>
</div>
<hr class="docutils" />
<section id="exponential-model">
<h2><span class="section-number">9.1. </span>Exponential model<a class="headerlink" href="#exponential-model" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="third/first_order-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 9.3 </span></p>
<section id="exercise-content">
<p>A loan company charges interest of <span class="math notranslate nohighlight">\(r\%\)</span> per month. Write this down in the form of a difference equation. Also write down the general solution given an initial investment of <span class="math notranslate nohighlight">\(M_0\)</span></p>
</section>
</div>
<div class="toggle docutils container">
<p>In each time step <span class="math notranslate nohighlight">\(\Delta t=1\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{\Delta M}{\Delta t} = \frac{\left(1+\frac{r}{100}\right)M-M}{1}=\frac{r}{100}M.
\end{equation*}\]</div>
<p>The equation may be rearranged as</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{1}{M}\frac{\Delta M}{\Delta t} = \frac{r}{100}.
\end{equation*}\]</div>
<p>The relative growth rate is constant, as we have seen previously for this model.</p>
</div>
<hr class="docutils" />
<div class="exercise admonition" id="third/first_order-exercise-3">

<p class="admonition-title"><span class="caption-number">Exercise 9.4 </span></p>
<section id="exercise-content">
<p>Write down a differential equation corresponding to the previous exercise, supposing that interest is compounded continuously, rather than monthly.</p>
</section>
</div>
<div class="toggle docutils container">
<p>If interest is compounded continuously then it is convenient to write</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
M=M_0 e^{\lambda t},
\end{equation*}\]</div>
<p>which we can do by taking <span class="math notranslate nohighlight">\(\lambda =\ln\left(1+\frac{r}{100}\right)\)</span>.</p>
<p>Differentiating then gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{1}{M}\frac{\mathrm{d}M}{\mathrm{d}t}=\lambda
\end{equation*}\]</div>
</div>
<div class="exercise admonition" id="third/first_order-exercise-4">

<p class="admonition-title"><span class="caption-number">Exercise 9.5 </span></p>
<section id="exercise-content">
<p>Given a module of discrete compound growth of a quantity <span class="math notranslate nohighlight">\(M\)</span> with growth factor <span class="math notranslate nohighlight">\(r\)</span> and initial value <span class="math notranslate nohighlight">\(M_0\)</span>, find the time to reach a given value.</p>
</section>
</div>
<div class="toggle docutils container">
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{M}{M_0}=(1+r)^t \quad &amp;\implies \quad \ln(M/M_0)=t\ln(1+r)\\
&amp; \implies t=\frac{\ln(M/M_0)}{\ln(1+r)}
\end{align*}\]</div>
</div>
<hr class="docutils" />
<div class="exercise admonition" id="third/first_order-exercise-5">

<p class="admonition-title"><span class="caption-number">Exercise 9.6 </span></p>
<section id="exercise-content">
<p>Let <span class="math notranslate nohighlight">\(x(t)\)</span> be the population of a given area at time <span class="math notranslate nohighlight">\(t\)</span>. Write down an expression for the per-capita rate of change of population change.</p>
<p>Convert this to an equation for <span class="math notranslate nohighlight">\(x(t)\)</span> by assuming that the per-capita rate of population change is equal to a constant <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
</section>
</div>
<div class="toggle docutils container">
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{1}{x}\frac{\mathrm{d}x}{\mathrm{d}t} = \mu \quad \implies \quad x = x_0 e^{\mu t}
\end{equation*}\]</div>
<p>We could also express the equation in relation to the doubling time <span class="math notranslate nohighlight">\(\tau\)</span>. For <span class="math notranslate nohighlight">\(x\)</span> to be doubled, <span class="math notranslate nohighlight">\(x/x_0=2\)</span> which gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
e^{\mu\tau}=2 \quad \Rightarrow \quad x=x_0 2^{t/\tau}\ .
\end{equation*}\]</div>
</div>
<hr class="docutils" />
<div class="exercise admonition" id="third/first_order-exercise-6">

<p class="admonition-title"><span class="caption-number">Exercise 9.7 </span></p>
<section id="exercise-content">
<p><a class="reference external" href="https://www.emcdda.europa.eu/publications/drug-profiles/cocaine_en">Cocaine</a> has a half-life of around 0.7-1.5 hour in human blood. Determine what percentage will remain after six hours.</p>
</section>
</div>
<div class="toggle docutils container">
<p>Let <span class="math notranslate nohighlight">\(\tau\)</span> be the half-life. Then, when <span class="math notranslate nohighlight">\(t=6\)</span>hrs,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{x}{x_0}=2^{-t/\tau} = \frac{1}{2^{6/\tau}} = [0.26 - 6.25]\%.
\end{equation*}\]</div>
<p>You may wish to compare this to the results for caffeine and alcohol, which each have a mean half-life of about 5 hours.</p>
</div>
</section>
<hr class="docutils" />
<section id="numeric-solution">
<h2><span class="section-number">9.2. </span>Numeric solution<a class="headerlink" href="#numeric-solution" title="Permalink to this heading">#</a></h2>
<p>Consider a general equation of the following form, where <span class="math notranslate nohighlight">\(f(x,t)\)</span> is a known function:</p>
<div class="math notranslate nohighlight" id="equation-std-prob">
<span class="eqno">(9.1)<a class="headerlink" href="#equation-std-prob" title="Permalink to this equation">#</a></span>\[\frac{\mathrm{d}x}{\mathrm{d}t} = f(x,t).\]</div>
<p>To obtain a numeric estimate of the solution we can use the discrete derivative formula</p>
<div class="amsmath math notranslate nohighlight" id="equation-2a4236aa-4c43-48fc-a08b-beff8f346f65">
<span class="eqno">(9.2)<a class="headerlink" href="#equation-2a4236aa-4c43-48fc-a08b-beff8f346f65" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\Delta x}{\Delta t}  =\frac{x_{i+1}-x_i}{h},
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the step size of <span class="math notranslate nohighlight">\(t\)</span>. By using this formula to estimate the continuous derivative in <a class="reference internal" href="#equation-std-prob">(9.1)</a> we the may obtain the rearrangement</p>
<div class="amsmath math notranslate nohighlight" id="equation-3a42440e-e67e-4a72-bbf1-0896ff0b0214">
<span class="eqno">(9.3)<a class="headerlink" href="#equation-3a42440e-e67e-4a72-bbf1-0896ff0b0214" title="Permalink to this equation">#</a></span>\[\begin{equation}
x_{i+1} = x_i + h f(x_i,t_i).
\end{equation}\]</div>
<p>This allows us to start from a given initial value <span class="math notranslate nohighlight">\(x_0\)</span> and “step forward” successively to obtain <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>, etc.</p>
<section id="example">
<h3><span class="section-number">9.2.1. </span>Example<a class="headerlink" href="#example" title="Permalink to this heading">#</a></h3>
<p>Consider the equation governing exponential growth/decay:</p>
<div class="amsmath math notranslate nohighlight" id="equation-3991855a-3839-4151-af20-38751e112256">
<span class="eqno">(9.4)<a class="headerlink" href="#equation-3991855a-3839-4151-af20-38751e112256" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\mathrm{d}x}{\mathrm{d}t} = \alpha x.
\end{equation}\]</div>
<p>The discrete formula for this problem is given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-a1de37b8-570d-4218-8efc-d16a3a3b00a8">
<span class="eqno">(9.5)<a class="headerlink" href="#equation-a1de37b8-570d-4218-8efc-d16a3a3b00a8" title="Permalink to this equation">#</a></span>\[\begin{equation}
x_{i+1} = (1+\alpha h)x_i.
\end{equation}\]</div>
<p>Notice that the solution grows if <span class="math notranslate nohighlight">\(\alpha&gt;0\)</span>, which matches what we expect to see for exponential growth.</p>
<p>The code below can be used to carry out the forward stepping and plot the solution. By comparing to the known solution we can find the size of the error on a given interval. Here, using a step size <span class="math notranslate nohighlight">\(h=0.02\)</span>, the maximum error is also around 0.02%.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">a</span><span class="o">=</span><span class="mf">0.1</span> <span class="c1">#alpha</span>

<span class="c1">#range of values to plot for</span>
<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1">#initialise solution array</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="c1"># forward stepping</span>
<span class="n">h</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#step size</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
  <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Calculate the error using the known solution</span>
<span class="n">x_sol</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">err</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x_sol</span><span class="p">)</span><span class="o">/</span><span class="n">x_sol</span>

<span class="c1"># Maximum error (as %)</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">err</span><span class="p">)))</span>
</pre></div>
</div>
</section>
</section>
<section id="offset-model">
<h2><span class="section-number">9.3. </span>Offset model<a class="headerlink" href="#offset-model" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="third/first_order-exercise-7">

<p class="admonition-title"><span class="caption-number">Exercise 9.8 </span></p>
<section id="exercise-content">
<p>In an offset exponential model, the rate of change of a quantity <span class="math notranslate nohighlight">\(Q\)</span> is proportional to the difference from some <strong>equilibrium</strong> value <span class="math notranslate nohighlight">\(Q_e\)</span> in the manner</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{\mathrm{d}Q}{\mathrm{d}t}=r(Q-Q_e)
\end{equation*}\]</div>
<p>By defining <span class="math notranslate nohighlight">\(D=(Q-Q_e)\)</span>, write down an equation for <span class="math notranslate nohighlight">\(\dot{D}\)</span> and solve it.</p>
<p>What do we mean when we say that <span class="math notranslate nohighlight">\(Q_e\)</span> is the equilibrium value?</p>
</section>
</div>
<div class="toggle docutils container">
<p>Let <span class="math notranslate nohighlight">\(D=(Q-Q_e)\)</span>, then</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{\mathrm{d}D}{\mathrm{d}t}=rD \quad \rightarrow \quad \rightarrow D=D_0 e^{r t}
\end{equation*}\]</div>
<p>The equilibrium value is the point where <span class="math notranslate nohighlight">\(\dot{Q}=0\)</span>. If the system reaches its equilibrium then it will remain there unless some external influence acts on the system to move it away from its equilibrium.</p>
</div>
<div class="exercise admonition" id="third/first_order-exercise-8">

<p class="admonition-title"><span class="caption-number">Exercise 9.9 </span></p>
<section id="exercise-content">
<p>Apply the offset equilibrium model to find the time taken for a drink to cool from 80C to 63C given an ambient (room) temperature of 20C, given that <span class="math notranslate nohighlight">\(r=-0.11\)</span>/min.</p>
</section>
</div>
<div class="toggle docutils container">
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\ln(D/D_0)=rt \quad \implies \quad t=\frac{1}{-0.11}\ln\left(\frac{63-20}{80-20}\right)=\frac{1}{0.11}\ln(60/43)
\end{equation*}\]</div>
<p>The drink will take 3 mins and 2 sec to reach ambient temperature.</p>
<p>Note that according to this model, the drink will never actually <em>reach</em> room temperature, though it will approach it in the limit.</p>
</div>
</section>
<section id="restricted-growth-models">
<h2><span class="section-number">9.4. </span>Restricted growth models<a class="headerlink" href="#restricted-growth-models" title="Permalink to this heading">#</a></h2>
<p>The Von Bertalanffy equation is the simplest example of a restricted growth model. It is provided by the equation,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{\mathrm{d}L}{\mathrm{d}t}=k(L_{\infty}-L),\qquad L(t_0)=0
\end{equation*}\]</div>
<p>It has solution</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
L=L_{\infty}\left(1-e^{-k(t-t_0)}\right)
\end{equation*}\]</div>
<p>A plot of this curve is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># example parameters</span>
<span class="n">k</span><span class="o">=</span><span class="mf">0.52</span><span class="p">;</span> <span class="n">Linf</span><span class="o">=</span><span class="mf">275.2</span><span class="p">;</span> <span class="n">t0</span><span class="o">=-</span><span class="mf">0.47</span><span class="p">;</span>

<span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># plot the function</span>
<span class="n">L</span><span class="o">=</span><span class="n">Linf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">L</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">Linf</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/vonbert.png"><img alt="von-bertalanffy" class="align-center" src="../_images/vonbert.png" style="width: 60%;" /></a>
<section id="to-be-continued">
<h3><span class="section-number">9.4.1. </span>To be continued…<a class="headerlink" href="#to-be-continued" title="Permalink to this heading">#</a></h3>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./third"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../second/powers.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">8. </span>Infinite powers</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../case-studies/chemicals.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">10. </span>Chemical concentrations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ella Metcalfe<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>