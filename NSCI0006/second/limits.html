
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>2. Know your limits &#8212; Mathematics for Natural Sciences B</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Placeholder" href="placeholder.html" />
    <link rel="prev" title="1. Rational functions" href="pfrac.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics for Natural Sciences B</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DATA TRENDS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../first/numbers.html">
   1. Representing numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/plotstuff.html">
   2. Graphing data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/exponentials.html">
   3. Exponential trends
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/curvefit.html">
   4. Curve fitting
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  RATES OF CHANGE
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="pfrac.html">
   1. Rational functions
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2. Know your limits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="placeholder.html">
   3. Placeholder
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DYNAMIC MODELS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../third/placeholder.html">
   Placeholder
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CASE STUDIES
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../case-studies/chemicals.html">
   1. Chemical concentrations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../case-studies/freshwater.html">
   2. Freshwater sustainability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../case-studies/coronavirus.html">
   3. Viral trends
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fsecond/limits.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/second/limits.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#informal-notion-of-limit">
   2.1. Informal notion of limit
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finite-limits">
   2.2. Finite limits
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#asymptotic-equivalence">
   2.3. Asymptotic equivalence
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-little-help-from-python">
   2.4. A little help from Python
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#do-limits-always-exist">
   2.5. Do limits always exist?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#limiting-sums">
   2.6. Limiting sums
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Know your limits</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#informal-notion-of-limit">
   2.1. Informal notion of limit
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finite-limits">
   2.2. Finite limits
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#asymptotic-equivalence">
   2.3. Asymptotic equivalence
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-little-help-from-python">
   2.4. A little help from Python
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#do-limits-always-exist">
   2.5. Do limits always exist?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#limiting-sums">
   2.6. Limiting sums
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="know-your-limits">
<h1><span class="section-number">2. </span>Know your limits<a class="headerlink" href="#know-your-limits" title="Permalink to this heading">#</a></h1>
<p>In this chapter we introduce the concept of a limit by studying some examples. We do not provide a formal or in-depth treatment of this topic, but by the end of the chapter you should be able to:</p>
<ul class="simple">
<li><p>use correct mathematical notation and language to describe a limit</p></li>
<li><p>deal with ratios of infinitesimally small or large quantities</p></li>
<li><p>find limits and asymptotic expansions either by hand or using Python</p></li>
<li><p>avoid misconceptions involving “a difference of infinities” or “a sum of infinitesimals”</p></li>
</ul>
<div class="quote admonition">
<p class="admonition-title"><a class="reference external" href="https://www.maa.org/press/periodicals/convergence/mathematical-treasure-berkeleys-critique-of-calculus#:~:text=%E2%80%9CThe%20ghosts%20of%20departed%20quantities,entitled%20The%20Analyst%20(1734).">Bishop George Berkeley (1685-1753)</a></p>
<p>And what are these Fluxions? The Velocities of evanescent Increments? And what are these same evanescent Increments? They are neither finite Quantities nor Quantities infinitely small, nor yet nothing. May we not call them the ghosts of departed quantities?</p>
</div>
<section id="informal-notion-of-limit">
<h2><span class="section-number">2.1. </span>Informal notion of limit<a class="headerlink" href="#informal-notion-of-limit" title="Permalink to this heading">#</a></h2>
<p>In the last chapter we saw that there are times when we may want to describe the behaviour of a function as its argument <em>approaches</em> a value without actually being equal to it. This is the idea that lies behind the mathematical definition of a limit.</p>
<p>By way of example, let us consider one of the functions that we looked at previously:</p>
<div class="math notranslate nohighlight" id="equation-thefrac">
<span class="eqno">(2.3)<a class="headerlink" href="#equation-thefrac" title="Permalink to this equation">#</a></span>\[y=\frac{3x^2+2x}{1-2x}.\]</div>
<p>In the last chapter we described the behaviour of this function as <span class="math notranslate nohighlight">\(x\)</span> approaches (“tends to”) the value of 1/2. We saw that the result is different as we approach from either the left or the right side of the <span class="math notranslate nohighlight">\(x\)</span>-axis [see <a class="reference internal" href="pfrac.html#asymptotes-03"><span class="std std-numref">Fig. 1.2</span></a>]. We may mathematically denote this by writing:</p>
<div class="math notranslate nohighlight" id="equation-oneside">
<span class="eqno">(2.4)<a class="headerlink" href="#equation-oneside" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{align*}
\lim_{x\rightarrow \left(\frac{1}{2}\right)^{-}}y=+\infty\\
\lim_{x\rightarrow \left(\frac{1}{2}\right)^{+}}y=-\infty
\end{align*}\end{split}\]</div>
<p>The expressions state that “in the limit” as <span class="math notranslate nohighlight">\(x\)</span> tends to <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>,</p>
<ul class="simple">
<li><p>from the left, <span class="math notranslate nohighlight">\(y\)</span> tends to positive infinity</p></li>
<li><p>from the right, <span class="math notranslate nohighlight">\(y\)</span> tends to negative infinity</p></li>
</ul>
<p>These are <em>one-sided</em> limits. Since the left- and right- sided limits are not the same, we cannot meaningfully speak of the limit as <span class="math notranslate nohighlight">\(x\)</span> tends to <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span> without specifying the direction, as indicated by the superscript <span class="math notranslate nohighlight">\(+/-\)</span> used in <a class="reference internal" href="#equation-oneside">(2.4)</a>.</p>
<p>For comparison, consider the function <span class="math notranslate nohighlight">\(1/x^2\)</span>. As <span class="math notranslate nohighlight">\(x\)</span> tends to zero the left- and right- sided limits of this function are both positive infinity and so we can simply say:</p>
<div class="amsmath math notranslate nohighlight" id="equation-91dee69f-9af3-4cac-b2dd-271064533384">
<span class="eqno">(2.5)<a class="headerlink" href="#equation-91dee69f-9af3-4cac-b2dd-271064533384" title="Permalink to this equation">#</a></span>\[\begin{equation}
\lim_{x\rightarrow 0}\frac{1}{x^2} = \infty.
\end{equation}\]</div>
<div class="exercise admonition" id="second/limits-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 2.7 </span></p>
<section id="exercise-content">
<p>What do you think is the correct result for:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
 \lim_{x \to \infty} ( x^2 - x ) \ ?
 \end{equation*}\]</div>
</section>
</div>
<div class="toggle docutils container">
<p>When considering the limiting difference between two arbitrarily large quantities, we need to be very careful.</p>
<p>In this example the limit appears to “go like” <span class="math notranslate nohighlight">\(\infty - \infty\)</span>, so you would be forgiven for thinking the result is zero. On the other hand, there is a sense in which <span class="math notranslate nohighlight">\(x^2\)</span> is “much bigger” than <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Indeed, if you try to substitute a large value of <span class="math notranslate nohighlight">\(x\)</span> into the function <span class="math notranslate nohighlight">\((x^2 - x)\)</span> you may infer that function can get arbitrarily large by making <span class="math notranslate nohighlight">\(x\)</span> sufficiently large.
So this limit appears to be infinity. This can be demonstrated by factorisation:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
(x^2 - x) = x (x-1)
\end{equation*}\]</div>
<p>Both parts of the factorised expression approach infinity, which demonstrates that the limit is positive infinity.</p>
</div>
</section>
<hr class="docutils" />
<section id="finite-limits">
<h2><span class="section-number">2.2. </span>Finite limits<a class="headerlink" href="#finite-limits" title="Permalink to this heading">#</a></h2>
<p>The limits in the examples above are infinite, but it doesn’t have to be that way. We saw an example in the previous chapter of a function with a horizontal asymptote (<a class="reference internal" href="pfrac.html#horiz-ass"><span class="std std-numref">Exercise 1.12</span></a>):</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\lim_{x\to\infty}\frac{x^2+3x+1}{(2x-3)(2x+3)}=\frac{1}{4}.
\end{equation*}\]</div>
<p>Although both the numerator and denominator here can get arbitrarily large, they do so at a similar rate (like <span class="math notranslate nohighlight">\(x^2/4x^2\)</span>) and so their ratio remains finite.</p>
<div class="exercise admonition" id="second/limits-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 2.8 </span></p>
<section id="exercise-content">
<p>Determine the following limit:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\lim_{x\to \infty}\frac{\sqrt{x^2 + 2} }{3 x}
\end{equation*}\]</div>
</section>
</div>
<div class="toggle docutils container">
<p>Using the technique of dividing both parts of the fraction by the largest power of <span class="math notranslate nohighlight">\(x\)</span> in the denominator:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\lim_{x\to \infty}\frac{\sqrt{x^2 + 2} }{3 x} = \lim_{x\to \infty}\frac{\sqrt{1 +\frac{2}{x^2}}}{3} =\frac{\sqrt{1+0}}{3}=\frac{1}{3}\ .
\end{equation*}\]</div>
</div>
<div class="exercise admonition" id="second/limits-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 2.9 </span></p>
<section id="exercise-content">
<p>Find the following limits:</p>
<p><span class="math notranslate nohighlight">\(\qquad \displaystyle\lim_{x\to\infty} \frac{x+2}{x^2-2}, \qquad \qquad \lim_{x\to\infty} \frac{x-2}{x+2}\)</span>.</p>
</section>
</div>
<div class="toggle docutils container">
<p><span class="math notranslate nohighlight">\(\displaystyle\lim_{x \to \infty}\frac{x+2}{x^2 - 2} = \lim_{x \to \infty} \frac{1/x + 2/x^2}{1-2/x^2}= \frac{0+0}{1+0}=0\)</span>.</p>
</div>
<div class="toggle docutils container">
<p><span class="math notranslate nohighlight">\(\displaystyle\lim_{x \to \infty}\frac{x-2}{x+2} = \lim_{x \to \infty} \frac{1 - 2/x}{1+2/x}= \frac{1-0}{1+0}=1\)</span>.</p>
</div>
<hr class="docutils" />
<p>In each of the above examples the numerator and the denominator “blow up”, but it is also possible for there to be a finite limit when both parts of a ratio to shrink to zero. For example, consider the following function:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
y=\frac{1-e^{-x}}{x}.
\end{equation*}\]</div>
<p>As <span class="math notranslate nohighlight">\(x\to 0\)</span> both the numerator and denominator approach zero, and so the limiting value of their ratio is not obvious. However, a plot of the function can give us a good idea:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/lim02.png"><img alt="fitted data" class="align-center" src="../_images/lim02.png" style="width: 60%;" /></a>
<p>The plot <em>suggests</em> that:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\lim_{x\rightarrow 0}\frac{1-e^{-x}}{x}=1
\end{equation*}\]</div>
<p>This is possible because whilst both the numerator and denominator tend to zero they do so at exactly the same rate (like <span class="math notranslate nohighlight">\(x/x\)</span>). In the next section we will learn how to find limits of this type.</p>
</section>
<section id="asymptotic-equivalence">
<h2><span class="section-number">2.3. </span>Asymptotic equivalence<a class="headerlink" href="#asymptotic-equivalence" title="Permalink to this heading">#</a></h2>
<p>Whereas the <em>limit</em> of a function refers to tendency towards a single value, asymptotic equivalence refers to tendency towards a relationship.</p>
<p>In the last chapter we learned how to construct asymptotes for rational fractions as <span class="math notranslate nohighlight">\(x\to \pm\infty\)</span>. For example, returning to <a class="reference internal" href="#equation-thefrac">(2.3)</a>, for large positive <span class="math notranslate nohighlight">\(x\)</span> the function has</p>
<ul class="simple">
<li><p>a <em>limit</em> of negative infinity</p></li>
<li><p>an <em>asymptote</em> <span class="math notranslate nohighlight">\(y=-\frac{3x}{2}-\frac{7}{4}\)</span>.</p></li>
</ul>
<p>We can develop deeper theory that allows us to construct asymptotically equivalent polynomials for almost any sort of continuous function and in almost any limit. This is one of the most important ideas in mathematics, because it allows us to find approximate analytic solutions to problems that may otherwise be too challenging to solve. Most commonly we are interested in results that are valid in the limit as <span class="math notranslate nohighlight">\(x\)</span> tends to zero.</p>
<p>We haven’t yet studied the required mathematical theory to construct asymptotic expansions from scratch, but we will return to this later in the module. For now, we merely state results for some common functions or obtain them using Python, without justification.</p>
<div class="note admonition">
<p class="admonition-title">Useful polynomial approximations (power series)</p>
<p>For “very small” <span class="math notranslate nohighlight">\(x\)</span>, the following expressions are asymptotically equivalent. In most practical applications we only need the first two or three terms.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{alignat}{12}
&amp;(1+x)^k  &amp;&amp; \sim 1 &amp;&amp;+kx             &amp;&amp;+\frac{1}{2}k(k-1)x^2 +\frac{1}{3!}k(k-1)(k-2)x^3 +\mathcal{O}(x^4)\\
&amp;e^x      &amp;&amp; \sim 1 &amp;&amp;+ \enspace x    &amp;&amp;+\frac{x^2}{2}   +\frac{x^3}{3}  +\mathcal{O}(x^4)\\
&amp;\sin(x)  &amp;&amp; \sim x &amp;&amp;-\frac{x^3}{3!} &amp;&amp;+\frac{x^5}{5!}  -\frac{x^7}{7!} +\mathcal{O}(x^9)\\
&amp;\cos(x)  &amp;&amp; \sim 1 &amp;&amp;-\frac{x^2}{2!} &amp;&amp;+\frac{x^4}{4!}  -\frac{x^6}{6!} +\mathcal{O}(x^8)\\
&amp;\ln(1+x) &amp;&amp; \sim x &amp;&amp; -\frac{x^2}{2} &amp;&amp;+\frac{x^3}{3}   -\frac{x^4}{4}  +\mathcal{O}(x^5)
\end{alignat}\end{split}\]</div>
</div>
<div class="exercise admonition" id="second/limits-exercise-3">

<p class="admonition-title"><span class="caption-number">Exercise 2.10 </span></p>
<section id="exercise-content">
<p>Using the result given above, write down the first three terms in the power series expression for <span class="math notranslate nohighlight">\((1+x)^{1/2}\)</span>. Estimate the maximum relative error in this expansion over the range <span class="math notranslate nohighlight">\([-0.2,0.2]\)</span>.</p>
</section>
</div>
<div class="toggle docutils container">
<p>Using the given expansion formula,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
(1+x)^{1/2} \sim 1+\frac{x}{2}-\frac{x^2}{8}
\end{equation*}\]</div>
<p>We can calculate the relative error for a list of values in the given range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y_asy</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">8</span>
<span class="n">y_act</span><span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">err</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_asy</span> <span class="o">-</span> <span class="n">y_act</span><span class="p">)</span><span class="o">/</span><span class="n">y_act</span>
</pre></div>
</div>
<p>It is a good idea to plot the relative error, to check for any odd behaviour, such as discontinuities. Here we plot the absolute value as we are interested in the relative size of the error and not the direction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="rel-err" class="align-center" src="../_images/lim01.png" />
<p>There is no odd behaviour here. We can see that the largest relative error on the range occurs when <span class="math notranslate nohighlight">\(x=-0.2\)</span>, and is about 0.064%.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">100</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0.0640419931155935</span></code></p>
</div>
<div class="exercise admonition" id="second/limits-exercise-4">

<p class="admonition-title"><span class="caption-number">Exercise 2.11 </span></p>
<section id="exercise-content">
<p>The sinc function appears often in engineering applications. It is defined for <span class="math notranslate nohighlight">\(x\neq 0\)</span> by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\mathrm{sinc}(x)=\frac{\sin(x)}{x}
\end{equation*}\]</div>
<p>What do you think is the value of this function in the limit <span class="math notranslate nohighlight">\(x\rightarrow 0\)</span> ?</p>
</section>
</div>
<div class="toggle docutils container">
<p>It is useful to plot the function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="sinc-function" class="align-center" src="../_images/sinc.png" />
<p>By inspecting the graph we are led to conclude that in the limit <span class="math notranslate nohighlight">\(x\rightarrow 0\)</span> the function approaches a finite value (one?) from both sides. Let’s see if we can verify this algebraically.</p>
<p>We can make use of the power series expression for <span class="math notranslate nohighlight">\(\sin(x)\)</span> given above:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{\sin(x)}{x} \sim \frac{x -\frac{x^3}{3!}+\mathcal{O}(x^5)}{x} = 1-\frac{x^2}{6}+\mathcal{O}(x^4).
\end{equation*}\]</div>
<p>Therefore we have formally shown that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\lim_{x\rightarrow 0}\frac{\sin(x)}{x} = 1.
\end{equation*}\]</div>
<p>The sinc function is undefined as <span class="math notranslate nohighlight">\(x=0\)</span>, but we can adjust the definition to take care of the hole discontinuity as follows:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\text{sinc}(x)=\begin{cases}\frac{\sin(x)}{x} &amp; x\neq 0 \\ 1 &amp; x=0\end{cases}
\end{equation*}\]</div>
</div>
</section>
<hr class="docutils" />
<section id="a-little-help-from-python">
<h2><span class="section-number">2.4. </span>A little help from Python<a class="headerlink" href="#a-little-help-from-python" title="Permalink to this heading">#</a></h2>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> library to find limits or asymptotically equivalent power series. The two expressions you can use to explore a function <span class="math notranslate nohighlight">\(y(x)\)</span> as <span class="math notranslate nohighlight">\(x\rightarrow x_0\)</span> are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">limit(y,x,x0)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">series(y,x,x0,n)</span></code></p></li>
</ul>
<p>The second expression gives the <span class="math notranslate nohighlight">\(n\)</span> term power series. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">series</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\displaystyle -\frac{1}{2}-\frac{x}{4}-\frac{x^2}{12}+\mathcal{O}(x^3)\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">series</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\displaystyle 2-2x+\frac{4x^2}{3}+\mathcal{O}(x^3)\)</span></p>
<p>We can verify these results using the given power series for <span class="math notranslate nohighlight">\(e^x\)</span>. For instance:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{1-e^{-2x}}{x}&amp;=\frac{1-(1-2x+\frac{(-2x)^2}{2}+\frac{(-2x)^3}{6})+\mathcal{O}(x^4)}{x}\\
&amp;=2-2x+\frac{4x^2}{3}+\mathcal{O}(x^3)
\end{align*}\]</div>
<p>We can also infer the following limits using the series expansions:</p>
<p><span class="math notranslate nohighlight">\(\begin{alignat}{5}
&amp;\lim_{x \to 0}\frac{1-e^x}{2x}   &amp;&amp;=\lim_{x\to 0}\left(-\frac{1}{2}+\mathcal{O}(x)\right)=-\frac{1}{2}\\
&amp;\lim_{x\to 0}\frac{1-e^{-2x}}{x} &amp;&amp;=\lim_{x\to 0}\left(2+\mathcal{O}(x)\right)=2
\end{alignat}\)</span></p>
<div class="exercise admonition" id="second/limits-exercise-5">

<p class="admonition-title"><span class="caption-number">Exercise 2.12 </span></p>
<section id="exercise-content">
<p>Find an <span class="math notranslate nohighlight">\(\mathcal{O}(x)\)</span> power series expansion for the following function, and deduce the limit as <span class="math notranslate nohighlight">\(x\)</span> tends to zero:</p>
<p><span class="math notranslate nohighlight">\(\qquad \displaystyle y=\frac{\sqrt{1-x^2}-\sqrt{1+x}}{x}\)</span>.</p>
</section>
</div>
<div class="toggle docutils container">
<p>For small <span class="math notranslate nohighlight">\(x\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
(1-x^2)^{1/2} &amp;= 1+\frac{1}{2}(-x^2)+\mathcal{O}(y^4)\\
(1+x)^{1/2}   &amp;= 1+\frac{1}{2}x -\frac{1}{8}x^2+\mathcal{O}(x^3)
\end{align*}\]</div>
<p>Therefore,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
y &amp;= \frac{\left(1-\frac{x^2}{2}\right)-\left(1+\frac{1}{2}x -\frac{1}{8}x^2\right) +\mathcal{O}(x^3)}{x}\\
  &amp;=\frac{1}{2}-\frac{3}{8}x+\mathcal{O}(x^2)
\end{align*}\]</div>
<p>In the limit:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\lim_{x\to 0}y = -\frac{1}{2}.
\end{equation*}\]</div>
<p>You can verify this using the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">series</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="exercise admonition" id="second/limits-exercise-6">

<p class="admonition-title"><span class="caption-number">Exercise 2.13 </span></p>
<section id="exercise-content">
<p>Find an <span class="math notranslate nohighlight">\(\mathcal{O}(1/x)\)</span> power series expansion for the following function, and deduce the limit as <span class="math notranslate nohighlight">\(x\)</span> tends to infinity:</p>
<p><span class="math notranslate nohighlight">\(\qquad \displaystyle\lim_{x \to \infty} \big( \sqrt{x^2-2} - \sqrt{x^2+x} \big)\)</span>.</p>
</section>
</div>
<div class="toggle docutils container">
<p>Where we require an asymptotic result for <span class="math notranslate nohighlight">\(f(x)\)</span> as <span class="math notranslate nohighlight">\(x\to \infty\)</span>, this is equivalent to <span class="math notranslate nohighlight">\(f(\frac{1}{y})\)</span> as <span class="math notranslate nohighlight">\(y\to 0^+\)</span>.</p>
<p>Introducing <span class="math notranslate nohighlight">\(y=1/x\)</span> gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\sqrt{x^2-1}-\sqrt{x^2+x} = \frac{\sqrt{1-y^2}-\sqrt{1+y}}{y}
\end{equation*}\]</div>
<p>This is identical to the problem we solved in <strong>[2]</strong>. Therefore the series expansion is given by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\frac{1}{2}-\frac{3}{8x}+\mathcal{O}\left(\frac{1}{x^2}\right).
\end{equation*}\]</div>
<p>and the limit is <span class="math notranslate nohighlight">\(-1/2\)</span>. You can verify the result again using Python:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">series</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="do-limits-always-exist">
<h2><span class="section-number">2.5. </span>Do limits always exist?<a class="headerlink" href="#do-limits-always-exist" title="Permalink to this heading">#</a></h2>
<p>Not all functions have a limit at all points. For example, consider the square root function <span class="math notranslate nohighlight">\(\sqrt{x}\)</span>, which is not real-valued for <span class="math notranslate nohighlight">\(x&lt;0\)</span>. This function only has a limit from the right at <span class="math notranslate nohighlight">\(x=0\)</span> and does not have a limit for negative values of <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>A more exotic example is given by the function shown in <a class="reference internal" href="#sinxminus1"><span class="std std-numref">Fig. 2.5</span></a>. The function oscillates faster approaching zero and does not approach a particular value, so it does not have a limit as <span class="math notranslate nohighlight">\(x\to 0\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="sinxminus1">
<img alt="../_images/sinxminus1.png" src="../_images/sinxminus1.png" />
<figcaption>
<p><span class="caption-number">Fig. 2.5 </span><span class="caption-text">A plot of the function <span class="math notranslate nohighlight">\(\sin(1/x)\)</span>.</span><a class="headerlink" href="#sinxminus1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="exercise admonition" id="second/limits-exercise-7">

<p class="admonition-title"><span class="caption-number">Exercise 2.14 </span></p>
<section id="exercise-content">
<p>Do either of the following limits exist?</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\lim_{x\to\infty}\sin(1/x), \qquad \lim_{x\to\infty}\sin(x)
\end{equation*}\]</div>
</section>
</div>
<div class="toggle docutils container">
<p>The first limit exists and is equal to 0.</p>
<p>The second limit does not exist.</p>
</div>
</section>
<section id="limiting-sums">
<h2><span class="section-number">2.6. </span>Limiting sums<a class="headerlink" href="#limiting-sums" title="Permalink to this heading">#</a></h2>
<p>The power series expansions that we saw above are examples of <em>infinite sums</em>. Although we usually keep only the first few terms in these sums, we can in principle keep going in the expansion up to arbitrarily high powers of <span class="math notranslate nohighlight">\(x\)</span>. It may be difficult to believe that when we add an infinite number of terms we can obtain a finite result. However, a relatively simple example may convince you of this fact.</p>
<p>Consider the sum below, containing <span class="math notranslate nohighlight">\(n\)</span> terms:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
S_n = \frac{1}{4}+\frac{1}{4^2}+\frac{1}{4^3}+\dots+\frac{1}{4^n}
\end{equation*}\]</div>
<p>In mathematical notation this would usually be written as follows, representing the sum from <span class="math notranslate nohighlight">\(k=1\)</span> to <span class="math notranslate nohighlight">\(n\)</span> of the given expression :</p>
<div class="math notranslate nohighlight" id="equation-geom-ser1">
<span class="eqno">(2.6)<a class="headerlink" href="#equation-geom-ser1" title="Permalink to this equation">#</a></span>\[\sum_{k=1}^{n}\left(\frac{1}{4}\right)^k.\]</div>
<p>A curious person could investigate this sum by calculating a result for the first few values of <span class="math notranslate nohighlight">\(n\)</span>. We could even plot the results to see if there is a visible pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span>
<span class="n">t</span><span class="o">=</span><span class="p">[</span><span class="n">r</span><span class="o">**</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)]</span> <span class="c1">#terms in series</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                <span class="c1">#running total</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/geometric_sum.png"><img alt="ratio" class="align-center" src="../_images/geometric_sum.png" style="width: 60%;" /></a>
<p>The plot gives the impression that the sum is approaching a constant value. If you try increasing the value of <span class="math notranslate nohighlight">\(n\)</span> you will find that the result numerically settles down (converges) to <code class="docutils literal notranslate"><span class="pre">0.33333333</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This result is not a proof. Sometimes a sum that that appears to be numerically converging to a finite limit may in fact be growing to infinity at an extremely slow rate, as demonstrated in the following example. Conversely, a sum that appears to be growing extremely large may be converging towards an extremely large (but finite) limit.</p>
</div>
<p>Sometimes the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> library in Python may be able to give us the limit of a sum <span class="math notranslate nohighlight">\(S_n\)</span> as the number of terms <span class="math notranslate nohighlight">\(n\)</span> tends to infinity. We can do it here for the sum given in <a class="reference internal" href="#equation-geom-ser1">(2.6)</a>. The result agrees with our numerical estimate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span>
<span class="n">Sum</span><span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="n">k</span><span class="p">,(</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">oo</span><span class="p">))</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">0.333333333333333</span></code></p>
<p>For this example we can understand the result graphically. We consider a unit square partitioned as shown below. The total shaded area represents the sum, and we can see from the picture that the result is finite. We can also note that for every shaded square there are two unshaded squares of the same size, so the shaded region represents 1/3 of the total area of the square.</p>
<figure class="align-default" id="geometric-series">
<img alt="../_images/geometric_series.png" src="../_images/geometric_series.png" />
<figcaption>
<p><span class="caption-number">Fig. 2.6 </span><span class="caption-text">A graphical representation of <span class="math notranslate nohighlight">\(\displaystyle\sum_{k=1}^{\infty}\left(\frac{1}{4}\right)^k\)</span></span><a class="headerlink" href="#geometric-series" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The sum we just considered is an example of a <em>geometric sum</em>, which means that it has the form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
S_n=\sum_{k=1}^{n}ar^{k-1}
\end{equation*}\]</div>
<p>We can find a general result for sums of this type using algebra. We do this by cross-elimination of terms:</p>
<p><span class="math notranslate nohighlight">\(\begin{alignat}{5}
S_n   &amp;= a + &amp;&amp; ar+ar^2+\dots +ar^{n-1}\\
r S_n &amp;=     &amp;&amp; ar+ar^2+\dots +ar^{n-1}+ar^n\\
\implies (1-r)S_n &amp;= a- &amp;&amp; ar^n\\
&amp;&amp;&amp;\implies      S_n = \frac{a(1-r^n)}{1-r}
\end{alignat}\)</span></p>
<p>If <span class="math notranslate nohighlight">\(r&lt;1\)</span> then as <span class="math notranslate nohighlight">\(n\to \infty\)</span>, <span class="math notranslate nohighlight">\(r^n\to 0\)</span> and so we obtain the famous geometric series formula:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b4cf84bb-ddca-4846-b21b-d83941a114ca">
<span class="eqno">(2.7)<a class="headerlink" href="#equation-b4cf84bb-ddca-4846-b21b-d83941a114ca" title="Permalink to this equation">#</a></span>\[\begin{equation}
S_{\infty} = \frac{a}{1-r}.
\end{equation}\]</div>
<p>For example, when <span class="math notranslate nohighlight">\(r=1/4\)</span>, the result is <span class="math notranslate nohighlight">\(S_\infty=1/3\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is important to give here a word of warning about infinite sums. If the terms in the sum shrink to zero in the limit, this is <em>not</em> sufficient to guarantee convergence. A counter-example is provided below.</p>
</div>
<p>Consider now the famous “harmonic series”, which is given by:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\sum_{k=1}^{\infty}\frac{1}{k}
\end{equation*}\]</div>
<p>Notice that the terms in this sum converge to zero:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\lim_{k\rightarrow\infty}\frac{1}{k}=0
\end{equation*}\]</div>
<p>Therefore you might expect that the sum would converge to a finite limit. Indeed, after a million terms the sum has still not exceeded a value of 15:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000000</span><span class="p">)]</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/harmonic_series.png"><img alt="harmonic series" class="align-center" src="../_images/harmonic_series.png" style="width: 60%;" /></a>
<p>After 100 million terms the sum still has not exceeded 20. However, we can prove that this sum does <em>not</em> converge to a finite limit by grouping together the terms as shown:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\sum_{k=1}^{\infty}\frac{1}{k}&amp;=1+\frac{1}{2}+\left(\frac{1}{3}+\frac{1}{4}\right)+\left(\frac{1}{5}+\frac{1}{6}+\frac{1}{7}\right)+\left(\frac{1}{8}+\frac{1}{9}+\frac{1}{10}+\frac{1}{11}\right)+\dots\\
&amp;&gt; 1+\frac{1}{2}+\frac{1}{2}+\frac{1}{2}+\dots
\end{align*}\]</div>
<p>This latter sum grows without bound.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./second"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="pfrac.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">1. </span>Rational functions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="placeholder.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Placeholder</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ella Metcalfe<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>