
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>3. Viral trends &#8212; Mathematics for Natural Sciences B</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="2. Freshwater sustainability" href="freshwater.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics for Natural Sciences B</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DATA TRENDS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../first/numbers.html">
   1. Representing numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/plotstuff.html">
   2. Graphing data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/exponentials.html">
   3. Exponential trends
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../first/curvefit.html">
   4. Curve fitting
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  RATES OF CHANGE
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../second/pfrac.html">
   1. Rational functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../second/limits.html">
   2. Know your limits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../second/placeholder.html">
   3. Placeholder
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  DYNAMIC MODELS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../third/placeholder.html">
   Placeholder
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CASE STUDIES
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="chemicals.html">
   1. Chemical concentrations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="freshwater.html">
   2. Freshwater sustainability
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. Viral trends
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fcase-studies/coronavirus.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/case-studies/coronavirus.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coronavirus-data">
   3.1. Coronavirus data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#daily-cases">
     3.1.1. Daily cases
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#growth-rates-and-r-values">
     3.1.2. Growth rates and R values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fitting-to-a-model">
     3.1.3. Fitting to a model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#internet-memes">
   3.2. Internet “memes”
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Viral trends</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coronavirus-data">
   3.1. Coronavirus data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#daily-cases">
     3.1.1. Daily cases
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#growth-rates-and-r-values">
     3.1.2. Growth rates and R values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fitting-to-a-model">
     3.1.3. Fitting to a model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#internet-memes">
   3.2. Internet “memes”
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="viral-trends">
<h1><span class="section-number">3. </span>Viral trends<a class="headerlink" href="#viral-trends" title="Permalink to this heading">#</a></h1>
<div class="quote admonition">
<p class="admonition-title"><a class="reference external" href="https://www.gov.uk/government/speeches/pm-statement-on-coronavirus-16-march-2020">Prime Minister’s statement</a></p>
<p>As we said last week, our objective is to delay and flatten the peak of the epidemic by bringing forward the right measures at the right time, so that we minimise suffering and save lives. And everything we do is based scrupulously on the best scientific advice.</p>
</div>
<p>In this case study we will experiment with fitting some data to the logistic and the Fréchet distributions. Each of these has a characteristic “sigmoidal” S-shape, which maxes them typically suitable for fitting viral data. What we see with viruses is:</p>
<ul class="simple">
<li><p>an initial “flat” period of little growth (the lag phase)</p></li>
<li><p>a period of exponential growth</p></li>
<li><p>a terminating plateau where transmission has almost reached the maximum possible</p></li>
</ul>
<p>We will explore these features and the models that describe them later in this course. For now, we simply state the equations for the two distributions, which are given below. The effect of the parameters in each model is similar, with <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(K\)</span> determining the location and scale of the distribution, and <span class="math notranslate nohighlight">\(s\)</span> determining the shape.</p>
<div class="amsmath math notranslate nohighlight" id="equation-f577910e-7159-4c53-a5a3-7d06989c8a22">
<span class="eqno">(3.8)<a class="headerlink" href="#equation-f577910e-7159-4c53-a5a3-7d06989c8a22" title="Permalink to this equation">#</a></span>\[\begin{align}
\text{Logistic :} \quad &amp;y = \frac{K}{1+e^{-(x-x_0)/s}}\\
\text{Fréchet :} \quad  &amp;y = e^{-\left(\frac{x-x_0}{K}\right)^{-s}}
\end{align}\]</div>
<p>A plot of the Fréchet distribution is shown below for particular choices of the parameters, by way of example. You may wish to experiment with plotting both the Fréchet and logistic function for a few different parameter values to see how they compare.</p>
<figure class="align-default" id="frechet-plot">
<a class="reference internal image-reference" href="../_images/frechet.png"><img alt="../_images/frechet.png" src="../_images/frechet.png" style="width: 60%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.4 </span><span class="caption-text">Plots of the Fréchet distribution (top) and its growth rate (bottom) for <span class="math notranslate nohighlight">\(x_0=0\)</span>, <span class="math notranslate nohighlight">\(K=1\)</span>, <span class="math notranslate nohighlight">\(s=3\)</span></span><a class="headerlink" href="#frechet-plot" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The exercises below will give you some practice at fitting data to either of these functions. It is easiest to do this if the data has been <em>normalised</em> to the range <span class="math notranslate nohighlight">\([0,1]\)</span>, though only the Fréchet distribution requires this normalisation.</p>
<section id="coronavirus-data">
<h2><span class="section-number">3.1. </span>Coronavirus data<a class="headerlink" href="#coronavirus-data" title="Permalink to this heading">#</a></h2>
<p>The <em>coronavirus (COVID-19) in the UK dashboard</em> is an up-to-date weekly government summary of key coronavirus metrics, such as levels of infection and hospitalisations. You can download the data from <a class="reference external" href="https://coronavirus.data.gov.uk/details/cases?areaType=nation&amp;areaName=England">coronavirus.data.gov.uk</a></p>
<p>The below plots are based on dashboard data to 22 Aug 2022, which can be found in <a class="reference external" href="https://liveuclac-my.sharepoint.com/:x:/r/personal/ucqssjm_ucl_ac_uk/Documents/Shared%20with%20Everyone/nsci0006_data/data_2022-Aug-17.csv?d=we4b7fe33e3584ed09f2f7bc4cd331472&amp;csf=1&amp;web=1&amp;e=qhjgm6"><code class="docutils literal notranslate"><span class="pre">data_2-22-Aug-17.csv</span></code></a>.</p>
<section id="daily-cases">
<h3><span class="section-number">3.1.1. </span>Daily cases<a class="headerlink" href="#daily-cases" title="Permalink to this heading">#</a></h3>
<p>First we simply plot the daily reported cases. The background shading in the plots below indicates periods of lockdown (red) and significant restriction (yellow). Mostly this is just importing and plotting data, though some work needs to be done to deal with the x-axis values, which are given as <em>dates</em>.</p>
<p>The code also shows how the data can be de-noised by averaging over a 14-day moving window. The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library provides a moving window filter for this purpose.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#import the data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_2022-Aug-17.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#data in reverse order</span>

<span class="c1">#get the columns that we are interested in np format</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;newCasesBySpecimenDate&#39;</span><span class="p">])</span>

<span class="c1">#x is in datestring format. Convert it to a day counter:</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span> <span class="k">as</span> <span class="n">dt</span>
<span class="n">date</span><span class="o">=</span><span class="n">dt</span><span class="o">.</span><span class="n">fromisoformat</span>

<span class="n">dt0</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="n">dt0</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>

<span class="c1">#set up the plot axis</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.2</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">y</span><span class="p">)])</span>

<span class="c1">#plot it</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c1">#Average in each two week (14 day) interval</span>
<span class="n">window_size</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span><span class="s1">&#39;cases&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window_size</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">smoothx</span><span class="o">=</span><span class="n">avg</span><span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span>
<span class="n">smoothy</span><span class="o">=</span><span class="n">avg</span><span class="p">[</span><span class="s1">&#39;cases&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">smoothx</span><span class="p">,</span><span class="n">smoothy</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="c1"># &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; Code to prettify can be inserted here</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The code that was used here to prettify the plot are shown below if you are interested to see how it was done. You do not need to be able to do it!</p>
<div class="toggle docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Key dates in pandemic timeline</span>
<span class="n">d</span><span class="o">=</span><span class="p">[]</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;2020-03-23&quot;</span><span class="p">)</span>     <span class="c1"># Start lockdown</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;2020-05-13&quot;</span><span class="p">)</span>     <span class="c1"># Restricted</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;2020-07-04&quot;</span><span class="p">)</span>     <span class="c1"># End lockdown</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;2020-11-05&quot;</span><span class="p">)</span>     <span class="c1"># Start lockdown</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;2020-12-02&quot;</span><span class="p">)</span>     <span class="c1"># Tiers</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;2021-01-05&quot;</span><span class="p">)</span>     <span class="c1"># Start lockdown</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;2021-03-08&quot;</span><span class="p">)</span>     <span class="c1"># End lockdown</span>

<span class="n">keydates</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">dt0</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>

<span class="c1"># Background shading</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">keydates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">keydates</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#ff2400&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>   <span class="c1">#1st lockdown</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">keydates</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">keydates</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#ffff00&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>   <span class="c1">#restricted</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">keydates</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">keydates</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#ff2400&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>   <span class="c1">#2nd lockdown</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">keydates</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">keydates</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#ffff00&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>   <span class="c1">#tiers</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">keydates</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">keydates</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#ff2400&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>   <span class="c1">#3rd lockdown</span>

<span class="c1"># Format tick marks and tick labels on x axis.</span>
<span class="c1"># Place a tick mark for first day of each month</span>

<span class="n">xticks</span><span class="o">=</span><span class="p">[]</span>
<span class="n">xtickl</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="p">):</span>
  <span class="n">yr</span><span class="o">=</span><span class="mi">2020</span><span class="o">+</span><span class="n">i</span><span class="o">//</span><span class="mi">12</span>
  <span class="n">mo</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
  <span class="n">datestr</span><span class="o">=</span><span class="n">dt</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span><span class="n">mo</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">datestr</span><span class="o">-</span><span class="n">dt0</span><span class="p">)</span><span class="o">.</span><span class="n">days</span><span class="p">)</span>
  <span class="n">xtickl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datestr</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%b-%y&quot;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">xtickl</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<figure class="align-default" id="covid-cases">
<a class="reference internal image-reference" href="../_images/covid_cases.png"><img alt="../_images/covid_cases.png" src="../_images/covid_cases.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.5 </span><span class="caption-text">Daily covid cases obtained from coronavirus (COVID-19) in the UK dashboard</span><a class="headerlink" href="#covid-cases" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="growth-rates-and-r-values">
<h3><span class="section-number">3.1.2. </span>Growth rates and R values<a class="headerlink" href="#growth-rates-and-r-values" title="Permalink to this heading">#</a></h3>
<p>The smoothed data can be used to estimate daily growth rates in reporting over the period, which are shown below as percentages. Despite being calculated by  crude methodology, the figures roughly match official statistics.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Growth rate estimates in moving window</span>
<span class="n">gr</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">smoothy</span><span class="p">)</span><span class="o">/</span><span class="n">smoothy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">smoothx</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">gr</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> <span class="c1"># add horizontal axis</span>
<span class="c1">#note: some code to prettify the plot and add a trendline is excluded</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="covid-gr">
<a class="reference internal image-reference" href="../_images/covid_gr.png"><img alt="../_images/covid_gr.png" src="../_images/covid_gr.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.6 </span><span class="caption-text">Daily (averaged) covid growth rates (%) estimated from data reports.</span><a class="headerlink" href="#covid-gr" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Estimating the R-number is a much more complicated business. Government values are based on aggregating calculations produced by mathematical models from several UK institutions. However, we can obtain a very rough-and-ready estimate of what the R value was a week ago by using the  formula <span class="math notranslate nohighlight">\(R_{est} = (1+6G)\)</span>, where <span class="math notranslate nohighlight">\(G\)</span> is the current growth rate as a decimal. Compare this plot with Fig 18 from a <a class="reference external" href="https://royalsociety.org/-/media/policy/projects/set-c/set-covid-19-R-estimates.pdf">Royal Society paper</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">smoothx</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">gr</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">30</span><span class="p">,</span><span class="mi">125</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">2.6</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="covid-rest">
<a class="reference internal image-reference" href="../_images/covid_rEst.png"><img alt="../_images/covid_rEst.png" src="../_images/covid_rEst.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.7 </span><span class="caption-text">Estimated R-value <span class="math notranslate nohighlight">\(R_{est} = (1+6G)\)</span>, where <span class="math notranslate nohighlight">\(G\)</span> is the growth rate as a decimal, offset by one week.</span><a class="headerlink" href="#covid-rest" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="fitting-to-a-model">
<h3><span class="section-number">3.1.3. </span>Fitting to a model<a class="headerlink" href="#fitting-to-a-model" title="Permalink to this heading">#</a></h3>
<p>Now let’s try to fit the data for the number of cases to a mathematical model. We will do this separately for each wave of the infection. The shading in the below plot is to identify the infection waves that we will look at.</p>
<p>The unfitted period between the identified third and fourth waves is peculiar. The sharp drop in cases coincides with the announcement of 19 July when legal limits on social contact were removed in England, including re-opening of nightclubs. For a timeline of restrictions, see <a class="reference external" href="https://www.instituteforgovernment.org.uk/sites/default/files/chart-images/timeline-coronavirus-lockdown-december-2021_0.png">this website</a>.</p>
<figure class="align-default" id="covid-waves">
<img alt="../_images/covid_waves.png" src="../_images/covid_waves.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.8 </span><span class="caption-text">Identifiable “waves” of infection are alternately highlighted in blue or yellow</span><a class="headerlink" href="#covid-waves" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="exercise admonition" id="case-studies/coronavirus-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 3.6 </span></p>
<section id="exercise-content">
<p>Choose one of the “waves” by eye and isolate the <span class="math notranslate nohighlight">\((x,y)\)</span> data for this interval. For the data that you identified :</p>
<ul class="simple">
<li><p>Normalise the <span class="math notranslate nohighlight">\(x\)</span> co-ordinate so that it runs from 0 to 1. You can do this by defining: <br>
<span class="math notranslate nohighlight">\(\qquad\quad\)</span> <code class="docutils literal notranslate"><span class="pre">xhat=(x-x[0])/(x[-1]-x[0])</span></code>.<br></br></p></li>
<li><p>Transform the <span class="math notranslate nohighlight">\(y\)</span> data to give a running total of infections, normalised to the range <span class="math notranslate nohighlight">\([0,1]\)</span>. You can do this by defining<br>
<span class="math notranslate nohighlight">\(\quad\qquad\)</span> <code class="docutils literal notranslate"><span class="pre">yhat=</span> <span class="pre">np.cumsum(y-min(y))/np.sum(y-min(y))</span></code>.<br></br></p></li>
<li><p>Fit the following “logistic” function to the (<code class="docutils literal notranslate"><span class="pre">xhat</span></code>,<code class="docutils literal notranslate"><span class="pre">yhat</span></code>) data and plot the fitted curve together with the data on the same axis:</p></li>
</ul>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\hat{y} = \frac{K}{1+e^{-(\hat{x}-\hat{x}_0)/s}}.
\end{equation*}\]</div>
<ul class="simple">
<li><p>Find the inverse transform corresponding to <code class="docutils literal notranslate"><span class="pre">yhat</span></code>, and apply it to your fitted curve to create a new figure. Show your result together with the original (untransformed) <span class="math notranslate nohighlight">\(y\)</span> data on the same axis.</p></li>
</ul>
<p>*Hint: The inverse of the <code class="docutils literal notranslate"><span class="pre">np.cumsum</span></code> function is the <code class="docutils literal notranslate"><span class="pre">np.diff</span></code> function.</p>
</section>
</div>
</section>
</section>
<section id="internet-memes">
<h2><span class="section-number">3.2. </span>Internet “memes”<a class="headerlink" href="#internet-memes" title="Permalink to this heading">#</a></h2>
<p>In 2012 the singer Carly Rae Jepsen released the song “Call Me Maybe”. The song was a huge worldwide hit and in Britain it become the second best-selling single of 2012. It’s popularity as an internet search term was further helped by viral videos which included a dance routine by the Miami dolphins cheerleaders and a parody by the US army.</p>
<p>We can obtain a log of interest over time in the search term “call me maybe” by interrogating <a class="reference external" href="https://trends.google.com/trends/?geo=GB">Google Trends</a>. The database allows you to search by timeframe and world location, and you can also distinguish between Google searches or YouTube searches.</p>
<p>The plot below shows the nomalised worldwide Google search data for the phrase call me maybe between 2/Jan/2011 and 28/Dec/2014. The data shows a surge in interest followed by a long, slow decline. This is similar to the data we saw for coronavirus cases, but with a longer tail.</p>
<p>Comparison of the plot with <a class="reference internal" href="#frechet-plot"><span class="std std-numref">Fig. 3.4</span></a> suggest that the search data may possibly be a good candidate to fit to the Fréchet function.</p>
<figure class="align-default" id="call-me-maybe">
<a class="reference internal image-reference" href="../_images/call-me-maybe.png"><img alt="../_images/call-me-maybe.png" src="../_images/call-me-maybe.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3.9 </span><span class="caption-text">Global interest over time in the search term <a class="reference external" href="https://trends.google.com/trends/explore?date=2011-01-02%202014-12-28&amp;geo=GB&amp;q=call%20me%20maybe">call me maybe</a>.</span><a class="headerlink" href="#call-me-maybe" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="exercise admonition" id="case-studies/coronavirus-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 3.7 </span></p>
<section id="exercise-content">
<p>Fit a Fréchet function to the cumulative search interest for the call me maybe dataset. Present any plots that you think are useful to demonstrate the quality of the fit.</p>
</section>
</div>
<div class="exercise admonition" id="case-studies/coronavirus-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 3.8 </span></p>
<section id="exercise-content">
<p>Use Google trends to obtain search data for your own choice of meme/viral video and fit either the logistic function or the Fréchet function to the cumulative data.</p>
<p>You can choose between Worldwide or specific country, you can also choose Google search data or YouTube data. Provide the url link to the dataset you used. Did you obtain a good fit? Why do you think this is?</p>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./case-studies"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="freshwater.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2. </span>Freshwater sustainability</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ella Metcalfe<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>