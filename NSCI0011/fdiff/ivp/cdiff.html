
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>6. Midpoint method &#8212; Finite Differences</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter exercise 1.3" href="../sol/chapex1.html" />
    <link rel="prev" title="5. Stability and stiffness" href="stability.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Finite Differences</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Finite Differences
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introductory material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dif/background.html">
   1. Preliminaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dif/powers.html">
   2. Infinite powers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dif/formulae.html">
   3. Formulae
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Initial Value Problems
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="background.html">
   4. Preliminaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stability.html">
   5. Stability and stiffness
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   6. Midpoint method
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Solutions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../sol/chapex1.html">
   Chapter exercise 1.3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sol/chapex2.html">
   Chapter exercise 3.5
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/ivp/cdiff.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fivp/cdiff.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/ivp/cdiff.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/ivp/cdiff.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-order-problem">
   6.1. First order problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#second-order-problem">
   6.2. Second order problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-derivative-rule">
     6.2.1. First derivative rule
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#second-derivative-rule">
     6.2.2. Second derivative rule
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-exercise">
   6.3. Chapter exercise
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Midpoint method</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-order-problem">
   6.1. First order problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#second-order-problem">
   6.2. Second order problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#first-derivative-rule">
     6.2.1. First derivative rule
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#second-derivative-rule">
     6.2.2. Second derivative rule
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-exercise">
   6.3. Chapter exercise
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell tag_remove-input docutils container">
</div>
<section class="tex2jax_ignore mathjax_ignore" id="midpoint-method">
<h1><span class="section-number">6. </span>Midpoint method<a class="headerlink" href="#midpoint-method" title="Permalink to this heading">#</a></h1>
<p>The explicit Euler method is rarely used in problems of real practical importance, as it often requires impractically small integration steps to achieve the required accuracy goal. However, it does appear as a sub-step in some other important multistep formulas.</p>
<p>The central difference (midpoint) formulas are of particular importance. They are very heavily used in numeric methods because they achieve a good balance between simplicity, stability and accuracy. In this chapter you will learn to apply the midpoint formula to an initial value problem.</p>
<p>After completing the chapter you should be able to:</p>
<ul class="simple">
<li><p>Use the first derivative midpoint rule to solve a first order IVP, either by using the explicit Euler method to obtain a starting value, or by obtaining a starting value from a more accurate rule such as the trapezoidal rule.</p></li>
<li><p>Use the second derivative midpoint rule to solve a second order IVP by introducing a “ghost point”, and recognise why we cannot use the explicit Euler method to obtain a starting value in this case.</p></li>
</ul>
<section id="first-order-problem">
<h2><span class="section-number">6.1. </span>First order problem<a class="headerlink" href="#first-order-problem" title="Permalink to this heading">#</a></h2>
<p>The general form of a (scalar) first order IVP is defined by a first order ODE together with the initial value of the variable:</p>
<div class="amsmath math notranslate nohighlight" id="equation-aef99ca8-e17c-4837-8534-762f458b2798">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-aef99ca8-e17c-4837-8534-762f458b2798" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\mathrm{d}x}{\mathrm{d}t} = f(t,x), \quad x(0)=x_0.
\end{equation}\]</div>
<p>We will demonstrate a quadratic order solution technique for this problem using the following example case:</p>
<div class="amsmath math notranslate nohighlight" id="equation-125a1962-ad9a-4802-a859-e9e36daeaf51">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-125a1962-ad9a-4802-a859-e9e36daeaf51" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\mathrm{d}x}{\mathrm{d}{t}}=\cos\left(t+\frac{\pi}{4}\right), \quad x(0)=\frac{1}{\sqrt{2}}.
\end{equation}\]</div>
<p>Application of the midpoint rule results in the following formula, which requires two starting points:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c52ad22e-8e66-4f62-920d-d37fe3384c42">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-c52ad22e-8e66-4f62-920d-d37fe3384c42" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{x_{k+1}-x_{k-1}}{2h} = f(t_k,x_k) \qquad \implies \qquad x_{k+1}=x_{k-1}+2hf(t_k,x_k).
\end{equation}\]</div>
<p>The IVP gives us only one starting point, but we can estimate a second starting point by using the explicit Euler formula for the first step only. Although this formula is an order of accuracy worse than the midpoint formula, we will only use it for a single step.</p>
<p>The code below implements the algorithm for our example problem, using various step sizes to explore the effect on the error. The output is a table of the maximum errors for each step size, from which it can be seen that the errors scale with <span class="math notranslate nohighlight">\(h^2\)</span>. Decreasing the step size by a factor of two decreases the error by a factor of four:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Libraries and definitions used in the following code</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span><span class="nb">abs</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="n">cos</span><span class="p">,</span><span class="n">sqrt</span>

<span class="c1"># Print function for tabulating output</span>
<span class="k">def</span> <span class="nf">print_errs</span><span class="p">(</span><span class="n">hvals</span><span class="p">,</span><span class="n">err</span><span class="p">):</span>
  <span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">hvals</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Step size&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1">Ratio&#39;</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">hvals</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">err</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">err</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">err</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hvals</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">**-</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span>    <span class="c1">#Range of step sizes to try</span>
<span class="n">err</span><span class="o">=</span><span class="p">[]</span>                                <span class="c1">#To record max errors</span>

<span class="n">xsol</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span>   <span class="p">:</span>  <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>      <span class="c1">#Analytic solution      </span>
<span class="n">dxdt</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span><span class="n">x</span> <span class="p">:</span>  <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>      <span class="c1">#Derivative definition</span>
<span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                          <span class="c1">#Initial condition</span>

<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hvals</span><span class="p">:</span> 
  <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>               <span class="c1">#Integration domain</span>
  <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">);</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x0</span>        <span class="c1">#Solution array                     </span>
  <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">dxdt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>         <span class="c1">#Explicit Euler (one step)</span>

  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">dxdt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="c1">#midpoint rule (remaining steps)</span>

  <span class="n">E</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xsol</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>             <span class="c1">#Max error on domain</span>
  <span class="n">err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>

<span class="n">print_errs</span><span class="p">(</span><span class="n">hvals</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>                 <span class="c1">#Print the errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step size 	Error 		Ratio
0.01562500 	0.00009823 	4.00035089
0.00781250 	0.00002456 	3.99996600
0.00390625 	0.00000614 	4.00000492
0.00195312 	0.00000153 	4.00000638
0.00097656 	0.00000038 	3.99999903
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although we can get by with the explicit Euler result for the first step, using a higher order result such as the trapezoidal rule will normally give a more accurate result. For this example, using the trapezoidal rule for the first step gives a global result that is about 1.5 times more accurate than if the explicit Euler result is used for the first step.</p>
</div>
</section>
<section id="second-order-problem">
<h2><span class="section-number">6.2. </span>Second order problem<a class="headerlink" href="#second-order-problem" title="Permalink to this heading">#</a></h2>
<p>The general form of a second order IVP is defined by a second order ODE together with the initial value of the variable and its derivative:</p>
<div class="math notranslate nohighlight" id="equation-ivp2">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-ivp2" title="Permalink to this equation">#</a></span>\[\frac{\mathrm{d}^2 x}{\mathrm{d}t^2}=f\left(t,x,\frac{\mathrm{d}x}{\mathrm{d}t}\right), \qquad x(t_0)=\alpha, \quad \frac{\mathrm{d}x}{\mathrm{d}t}\biggr|_{t=t_0}=\beta.\]</div>
<p>We will demonstrate solution techniques for this problem using the following example case:</p>
<div class="math notranslate nohighlight" id="equation-6-6">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-6-6" title="Permalink to this equation">#</a></span>\[\ddot{x}=-\sin\left(t+\frac{\pi}{4}\right), \quad x(0)=\dot{x}(0)=\frac{1}{\sqrt{2}}.\]</div>
<section id="first-derivative-rule">
<h3><span class="section-number">6.2.1. </span>First derivative rule<a class="headerlink" href="#first-derivative-rule" title="Permalink to this heading">#</a></h3>
<p>The second order problem can be re-written as a first order IVP by definining <span class="math notranslate nohighlight">\(y=\dot{x}\)</span> to obtain</p>
<div class="amsmath math notranslate nohighlight" id="equation-041557af-da8f-49c6-a91b-5c4e06c596f2">
<span class="eqno">(6.6)<a class="headerlink" href="#equation-041557af-da8f-49c6-a91b-5c4e06c596f2" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\mathrm{d}\underline{x}}{\mathrm{d}t}=\underline{F}(t,\underline{x}), \qquad \underline{x}(t_0)=\begin{bmatrix}\alpha\\\beta\end{bmatrix}, \qquad \underline{x}=\begin{bmatrix}x\\y\end{bmatrix}.
\end{equation}\]</div>
<p>Therefore it could be solved using the midpoint method with a single explicit Euler step at the start, as above for the scalar case. In general, a <span class="math notranslate nohighlight">\(n\)</span>th order IVP can be re-cast in this way as a first order IVP with <span class="math notranslate nohighlight">\(n\)</span> dependent variables.</p>
<p>For our example problem we obtain</p>
<div class="amsmath math notranslate nohighlight" id="equation-93f3c21e-5b1e-4c67-9dfc-89c2901a4f47">
<span class="eqno">(6.7)<a class="headerlink" href="#equation-93f3c21e-5b1e-4c67-9dfc-89c2901a4f47" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{\mathrm{d}}{\mathrm{d}t}\begin{bmatrix}x\\y\end{bmatrix}=\begin{bmatrix}y\\-\sin(t+\pi/4)\end{bmatrix}, \qquad \begin{bmatrix}x(0)\\y(0)\end{bmatrix}=\frac{1}{\sqrt{2}}\begin{bmatrix}1\\1\end{bmatrix}.
\end{equation}\]</div>
<p>The code below implements the algorithm for our example problem, using various step sizes to explore the effect on the error. From the output table it can be again seen that the errors scale with <span class="math notranslate nohighlight">\(h^2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">err</span><span class="o">=</span><span class="p">[]</span>                                  <span class="c1">#Reset the error array</span>

<span class="c1"># Define the first order ODE system</span>
<span class="k">def</span> <span class="nf">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">X</span><span class="p">):</span>
  <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">X</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)])</span>

<span class="n">X0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>              <span class="c1">#Initial condition</span>

<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hvals</span><span class="p">:</span> 
  <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>                 <span class="c1">#Domain</span>
  <span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="mi">2</span><span class="p">));</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">X0</span><span class="p">;</span>      <span class="c1">#Two-column solution array</span>
  <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>           <span class="c1">#Explicit Euler (1 step)</span>

  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">dXdt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>   <span class="c1">#Midpoint rule (remaining steps)</span>
  
  <span class="n">E</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xsol</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>          <span class="c1">#Max error on domain</span>
  <span class="n">err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>

<span class="n">print_errs</span><span class="p">(</span><span class="n">hvals</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>                   <span class="c1">#Print the errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step size 	Error 		Ratio
0.01562500 	0.00036135 	3.96003168
0.00781250 	0.00009034 	4.00004880
0.00390625 	0.00002258 	4.00001220
0.00195312 	0.00000565 	4.00000305
0.00097656 	0.00000141 	4.00000079
</pre></div>
</div>
</div>
</div>
</section>
<section id="second-derivative-rule">
<h3><span class="section-number">6.2.2. </span>Second derivative rule<a class="headerlink" href="#second-derivative-rule" title="Permalink to this heading">#</a></h3>
<p>For the partial differential equations that we will encounter later, it is not possible to rewrite them in the manner of a first order system. Therefore we will need to use the finite difference formulae for the higher derivatives. In preparation for this, we will demonstrate the basic technique using our example problem.</p>
<p>Subsituting the second derivative midpoint formula into <a class="reference internal" href="#equation-6-6">(6.5)</a> gives</p>
<div class="amsmath math notranslate nohighlight" id="equation-df215caf-4c23-4984-b2fc-12200ccdabd8">
<span class="eqno">(6.8)<a class="headerlink" href="#equation-df215caf-4c23-4984-b2fc-12200ccdabd8" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{x_{k+1}-2x_k+x_{k-1}}{h^2}=\sin\left(t_k+\frac{\pi}{4}\right) \qquad \implies \qquad x_{k+1}=2x_k-x_{k-1}+h^2 \sin\left(t_k+\frac{\pi}{4}\right)
\end{equation}\]</div>
<p>Again, we require two starting points and it is natural for us to try using the explicit Euler formula for the first step. Unfortunately, it turns out that doing so contaminates the accuracy of the entire solution and results in global accuracy no better than <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span>, as demonstrated below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">err</span><span class="o">=</span><span class="p">[]</span>                               <span class="c1">#Reset the error array</span>

<span class="n">d2xdt2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span><span class="n">x</span> <span class="p">:</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>   <span class="c1">#Define 2nd order ODE</span>
<span class="n">x0</span> <span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">x0p</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>         <span class="c1">#Initial condition</span>

<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hvals</span><span class="p">:</span> 
  <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>              <span class="c1">#Domain</span>
  <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">);</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x0</span><span class="p">;</span>      <span class="c1">#Solution array</span>
  <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">x0p</span>                      <span class="c1">#Explicit Euler (1 step)</span>

  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">d2xdt2</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="c1">#Midpoint rule</span>

  <span class="n">E</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xsol</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>            <span class="c1">#Max error on domain</span>
  <span class="n">err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>

<span class="n">print_errs</span><span class="p">(</span><span class="n">hvals</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>                <span class="c1">#Print the errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step size 	Error 		Ratio
0.01562500 	0.03478967 	2.00519336
0.00781250 	0.01737225 	2.00260000
0.00390625 	0.00868048 	2.00130084
0.00195312 	0.00433883 	2.00065063
0.00097656 	0.00216940 	2.00001436
</pre></div>
</div>
</div>
</div>
<p>When we used the explicit Euler method for a single step in the first derivative form of this problem it worked ok, so why not here?</p>
<p>The explanation is very subtle, but is due to the way that the second derivative formula propagates errors. It can be shown that the errors <span class="math notranslate nohighlight">\(E_k\)</span> in midpoint formulae obey</p>
<ul class="simple">
<li><p>1st derivative: <span class="math notranslate nohighlight">\(\quad\  E_{k+1}=E_{k-1}+\mathcal{O}(h^3)\)</span></p></li>
<li><p>2nd derivative: <span class="math notranslate nohighlight">\(\quad E_{k+1} = 2E_k-E_{k-1}+\mathcal{O}(h^3)\)</span></p></li>
</ul>
<p>The error introduced by the explicit Euler formula in the first step is <span class="math notranslate nohighlight">\(E_1=\mathcal{O}(h^2)\)</span>. Applying the above formulae recursively with this error gives a global error of <span class="math notranslate nohighlight">\(\mathcal{O}(h^2)\)</span> in the first derivative approximation and a global error of <span class="math notranslate nohighlight">\(\mathcal{O}(h)\)</span> in the second derivative approximation.</p>
<p>So, we need to use a result for the first step that has the same order of accuracy as the midpoint method. There are lots of ways to do this, but we will use a technique that is based on the midpoint formula. We will be able to implement the same method later to also solve partial differential equations.</p>
<p>The trick involves the introduction of a “ghost point” <span class="math notranslate nohighlight">\(x_{-1}\)</span> outside the solution domain. Application of the midpoint rule to the initial condition for the derivative then gives the following result, which can be solved simultaneously with the update rule to obtain <span class="math notranslate nohighlight">\(x_1\)</span> :</p>
<div class="amsmath math notranslate nohighlight" id="equation-7a295648-46f1-42bc-a5fd-fd119752e0c9">
<span class="eqno">(6.9)<a class="headerlink" href="#equation-7a295648-46f1-42bc-a5fd-fd119752e0c9" title="Permalink to this equation">#</a></span>\[\begin{equation}
\frac{x_1-x_{-1}}{2h}=x_0^{\prime}.
\end{equation}\]</div>
<div class="exercise admonition" id="ivp/cdiff-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 6.1 </span></p>
<section id="exercise-content">
<p>By combining the equation above with the second differerence update rule and initial value <span class="math notranslate nohighlight">\(x_0\)</span>, obtain a result for <span class="math notranslate nohighlight">\(x_1\)</span>. Replace the explicit Euler step with your result, and show the the global error is reduced to <span class="math notranslate nohighlight">\(\mathcal{O}(h^2)\)</span>.</p>
</section>
</div>
<div class="toggle docutils container">
<p>For this problem, we have the following rules</p>
<div class="amsmath math notranslate nohighlight" id="equation-7205671b-7db4-4182-a509-5cc011fdce42">
<span class="eqno">(6.10)<a class="headerlink" href="#equation-7205671b-7db4-4182-a509-5cc011fdce42" title="Permalink to this equation">#</a></span>\[\begin{equation}
x_{1}=2x_0-x_{-1}+h^2 x_0^{\prime\prime}, \qquad x_1 = x_{-1}+2hx_0^{\prime}.
\end{equation}\]</div>
<p>Solving simultaneously gives</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
x_1=x_0+hx_0^{\prime}+\frac{h^2}{2} x_0^{\prime\prime}.
\end{equation*}\]</div>
<p>This may be implemented by changing the one-step Euler calculation to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x0</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">x0p</span><span class="o">+</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">d2xdt2</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x0</span><span class="p">)</span>
</pre></div>
</div>
<p>You should see that the error then decreases quadratically with <span class="math notranslate nohighlight">\(h\)</span>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The moral of the story is that if we are using the second derivative formula we need to implement a second order boundary condition.</p>
</div>
</section>
</section>
<section id="chapter-exercise">
<span id="cauchy-example"></span><h2><span class="section-number">6.3. </span>Chapter exercise<a class="headerlink" href="#chapter-exercise" title="Permalink to this heading">#</a></h2>
<p>Implement the midpoint method using the second derivative rule to solve the following second order linear IVP with step size <span class="math notranslate nohighlight">\(h=0.001\)</span>, and produce a plot of the errors:</p>
<div class="math notranslate nohighlight" id="equation-2order-cau">
<span class="eqno">(6.11)<a class="headerlink" href="#equation-2order-cau" title="Permalink to this equation">#</a></span>\[\ddot{x} + 2\dot{x}+10 x = 0, \qquad x(0)=1, \quad \dot{x}(0)=-1.\]</div>
<p>The analytic solution of this IVP is given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-108dd70b-20c9-4fe5-84e5-261e2cc41838">
<span class="eqno">(6.12)<a class="headerlink" href="#equation-108dd70b-20c9-4fe5-84e5-261e2cc41838" title="Permalink to this equation">#</a></span>\[\begin{equation}
x = e^{-3t}\cos(3t).
\end{equation}\]</div>
<p>A plot of the analytic solution is shown below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arange</span><span class="p">,</span><span class="n">cos</span><span class="p">,</span><span class="n">exp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.xmargin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">h</span><span class="o">=</span><span class="mf">0.01</span>
<span class="n">t</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>
<span class="n">xsol</span><span class="o">=</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">xsol</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cdiff_9_0.png" src="../_images/cdiff_9_0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ivp"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="stability.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">5. </span>Stability and stiffness</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../sol/chapex1.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter exercise 1.3</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Natural Sciences<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>